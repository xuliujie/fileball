var colorRange=["#c7413b"],curDepositItems=0,jackpotWinnerModal={id:"jackpotWinnerModal",isFull:!1,title:"Congratulations!",content_com:"jackpot-winner",modal_icon:"jackpot-winner-icon",text_save:"",text_close:"Okay"},currentCounter={gid:null,timer:new Timer};currentCounter.timer.addEventListener("secondsUpdated",function(a){a=currentCounter.timer.getTimeValues();$("#least_minutes").text(a.minutes);$("#least_seconds").text(a.seconds)});currentCounter.timer.addEventListener("targetAchieved",function(a){});
function toggleItems(a){$(a).parents(".table-bet").next().toggle("fast")}function formatShowItems(a){for(var b=[],c=0;c<a.deposits.length;c++)b=b.concat(a.deposits[c].items);b=b.sort(compareItem);8<=b.length&&(b=b.slice(0,8));return b}
function formatMySummary(a){for(var b=$('meta[name="steamid"]').data("value"),c=0,h=0,e=0;e<a.deposits.length;e++){var d=a.deposits[e];d.steamer.steamid===b&&(c+=d.items.length,h+=d.amount)}b=0;0<a.total_amount&&($("#my_jackpot_joining").text("Joining"),b=parseFloat((100*h/a.total_amount).toFixed(2)));curDepositItems=c;animateNumber("#my_jackpot_amount",c,!1);animateNumber("#my_jackpot_percent",b,!0)}
function setupCountdown(a){var b=a.countdown;if(currentCounter.gid!==a.uid&&a.run_ts){var c=Math.floor(Date.now()/1E3)-a.run_ts;b-=c;0<b&&currentCounter.timer.start({countdown:!0,startValues:{seconds:b}});currentCounter.gid=a.uid}}function getNextColor(a){return colorRange[a%colorRange.length]}Vue.component("steamer",{template:"#steamer_template",delimiters:["^{","}"],props:["item"]});Vue.component("jackpot-winner",{template:"#jackpot_winner_template",delimiters:["^{","}"],props:["item"]});
Vue.component("jackpot-winner-icon",{template:"#jackpot_winner_icon_template"});
Vue.component("scroll-sel",{template:"#scroll_template",delimiters:["^{","}"],props:["deposit"],created:function(){},mounted:function(){var a=this,b=$("#"+a.deposit.uid+" .slidee");b.css({width:80*a.deposit.joiners.length});var c="translate("+(240-(80*a.deposit.win_index+(1+Math.floor(79*Math.random()))))+"px, 0)";setTimeout(function(){$("#rolling_audio")[0].play();b.css({"-webkit-transform":c})},1E3);setTimeout(function(){a.$emit("winnerRolled")},8E3)},updated:function(){}});
Vue.component("jackpot_detail",{template:"#jackpot_detail_template",delimiters:["^{","}"],props:["item","index"],components:{panel:VueStrap.panel},data:function(){return{rolled:!!this.item.winner}},methods:{onWinnerRolled:function(){this.deposit=null;this.rolled=!0;var a=$('meta[name="steamid"]').data("value");this.item.winner.steamer.steamid===a&&this.showJackpotWinner(this.item.hash)},showJackpotWinner:function(){modalArea.modalData=jackpotWinnerModal;modalArea.contentData=this.item;Vue.nextTick(function(){$("#jackpotWinnerModal").modal("show")})}}});
$(function(){var a=$("#noSocket");a.show();var b=new ReconnectingWebSocket(("https:"==window.location.protocol?"wss":"ws")+"://"+window.location.host+"/ws/?page=jackpot");b.onopen=function(f){a.hide()};var c={user:{join_amount:{min:1,max:12E3},join_isteam:0,join_team:0},settings:{minamount:1,maxitems:12},gid:""},h={id:"inventoryModal",isFull:!0,title:"Join Jackpot",content_com:"inv-deposit",modal_icon:"",text_save:"",text_close:"Okay"},e=new Vue({el:"#item_wrapper",delimiters:["^{","}"],data:{items:[]}}),
d=new Vue({el:"#jackpot_summary",delimiters:["^{","}"],data:{totalCount:0,steam_bot:!0,depositStatus:"Not In"},created:function(){var f=this;depositBus.$on("deposited",function(a){1===a.type&&(f.depositStatus=a.message)})},mounted:function(){resizeKnob()},updated:function(){},methods:{resetKnob:function(){this.totalCount=0},renderKnob:function(){var a=$("#jackpot_knob_item");a.animate({value:this.totalCount},{duration:500,easing:"swing",step:function(){a.val(Math.ceil(this.value)).trigger("change")}})},
updateJackpotKnobs:function(a){for(var f=0,b=0;b<a.deposits.length;b++)f+=a.deposits[b].items.length;this.totalCount=f;this.renderKnob()}}}),g=new Vue({el:"#winner_wrapper",delimiters:["^{","}"],data:{checked:!1,histories:[]},created:function(){},mounted:function(){},updated:function(){}});b.onmessage=function(a){a=JSON.parse(a.data);if("message"==a[0])for(var b=0;b<a[1].length;b++)messageWrapper.addMessage({id:a[1][b].id,icon:a[1][b].steamer.icon,steamid:a[1][b].steamer.steamid,msg:a[1][b].message,
name:a[1][b].steamer.name});else"jk"==a[0]?(b=null,"new"==a[1]?(b=a[2],console.log(b),d.resetKnob(),d.renderKnob(),8<=g.histories.length&&g.histories.pop(),g.histories.unshift(b),$("#my_jackpot_joining").text("Not in")):"update"==a[1]?(b=a[2],g.histories.splice(0,1,b)):"history"==a[1]&&(b=a[2][0],g.histories=a[2]),b&&(e.items=formatShowItems(b),animateNumber("#deposit_item_count",b.total_items,!1),animateNumber("#jackpotTotalAmount",b.total_amount,!0),d.updateJackpotKnobs(b),formatMySummary(b),setupCountdown(b))):
"online"==a[0]?(b=$(".users-online-value"),b.empty(),b.append(a[1])):"bot"===a[0]&&(d.steam_bot=a[1].status,updateBotStatus(a[1].status))};$("#pushChatMsg").click(function(a){a=$("#chat_msg");var c={message:a.val()};b.send(JSON.stringify(c));a.val("").focus();return!1});$("#jackpot_deposit_button").click(function(){modalArea.modalData=h;c.settings.maxitems=12-curDepositItems;modalArea.contentData=c;modalArea.extraData={depositUrl:"/betting/jackpot/",type:1,showTeam:!1};Vue.nextTick(function(){$("#inventoryModal").modal("show")})});
setTimeout(function(){},4E3)});